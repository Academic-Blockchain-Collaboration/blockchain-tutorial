**12.12-BTC-匿名性(Av37065233,P12)**

好，今天我们讲一下比特币中的匿名性。

比特币是匿名的吗？同学们觉得匿名性是怎么定义的？什么叫匿名？一般来说，大家认为匿名是跟隐私保护联系在一起的，就跟privacy联系的。

对于大多数人来说，这个privacy的意思是你干的事情不希望让别人知道。

比特币中不要求用真名，可以用公钥产生的地址。所以从这一点上来说，它有一定的匿名性。你可以产生任意多个地址，然后用不同的地址干不同的事情。但是他不是说完全没有名字，就他用的是个化名，所以有人认为他用的这种叫做。

大家知道北大最著名的景点是什么？你们觉得是什么？未明湖对吧？未明湖叫什么？

I name的lake个就真正是没有名字的湖，叫未名湖，这个不叫anonymous
nake，不是说匿名的虎。所以说比特币中的匿名，它不是一种真的匿名，它是一种假的匿名。就好像很多作家写作的时候有笔名，有些人在网上发帖子时候用各种各样的网名。

这是一样的。

这个匿名性大概有多好呢？就他能给我们提供什么样的隐私保护呢？比如说跟法币相比，跟美元相比怎么样？跟现今相比呢。

比如跟我们手里的现金相比，它的匿名性没有现金好。这个是完全匿名的，上面没有任何关于这个人的任何信息，假名都没有。所以很多非法交易用大额现金，用现金的问题就在于他不是很容易保管和运输。

跟银行存款相比？大家觉得比特币的匿名性跟银行存款相比哪个好？因为比特币好点，为什么比特币自己注册或者。

因为你到银行账户的话是实名制，你得要提交你的一些身份的信息，然后才能注册一个银行账户。而比特币的话不需要，所以从这点上说，它的匿名性比比特币要好。其实国内的银行以前不是要求实名制就可以用化名的。就以前我上大学的时候，你去银行存款，你可以编一个名字，他不查身份证。然后将来你取钱的时候，就拿这个纯折去取，谁有纯折就可以把钱取出来。他以前是可以用化名的，这个实际上持续了很长一段时间。到我上大学的时候都可以用化名。有的同学听了很惊讶，后来改成了实名制。如果银行用化名的话，隐私性、匿名性跟比特币相比哪个好？

你认为还是比特币？为什么？因为比特币只是在网上做这。你还得拿存折，去年行，你本人还得谁用这个钱，就是谁就拿存折。你说因为比特币是在网上交易的，银行的话，你就算是化名，你取钱的时候你还得人去取，这个其实牵扯到一个很重要的问题，比特币你如果把钱要取出来怎么办？你在网上做交易这个没有问题，但是你网上那些交易最终是要跟实体世界发生联系的。比如说你要网上买个东西，那个商家得把东西发给你。你要用比特币换成法币，换成美元，你还是得有办法把钱取出来。

从某种意义上说，如果银行允许用化名的话，它的匿名性比比特币要好，为什么呢？比特币这个区块链的账本是公开的，所有人都能查的。而银行的账本是受控制的，银行里面工作人员可以查得到。然后有一些司法手段可以调取银行的信息。但是普通老百姓你说要查一下别人的账，你是查不到的。所以他这方面控制的比特币要好。比特币是完全公开的，每个人你都可以上区块链，把整个信息都下载下来。大家听明白了吗？

好，我们再说一下比特币当中什么情况下有可能破坏匿名性。从表面上看，就很多第一次接触比特币的人都觉得比特币的匿名性非常好。我需要用到账户，我生成一个公司要对，然后下次我再需要生成一个账户，我再这么干一次。有的人实际上推荐你每次收款的时候都用一个新的地址。这样的话你有各种各样不同的地址，谁也不知道哪些是属于你的，这好像匿名性很强。但是实际上有很多情况下，你创造的这些不同的地址是可以被关联在一起的。大家想想为什么？我们以前讲的哪些操作是可以让你把不同的地址关联在一起。

比如网上购物，比特币交易允许有多个输入和多个输出，对不对？比如你想去买东西。比如这个交易的input。可能有两个账户，一个是第一个地址中来的，然后是第二个地址来了。Output也可以有两个。

比如说第三个地址。这是第四个地点。假设有这么一个交易发布到了区块链上，它能告诉我们什么？

这个address一跟address
2很有可能是同一个人的，因为这个人同时控制这两个账户的私钥，对不对？为什么会出现多个输入？因为你要买的那个东西一般很难，恰好是你某一个账户的全部的值，所以他会有多个输也会有多个输出。就这两个地址中有一个很可能是个找零钱的地址，就你网上买个东西，那个东西花的钱，剩下那部分钱你转给你的一个新地址。这种交易一般都是比特币钱包软件生成的。很多钱包软件它每次交易的时候会自动生成一个新的找零的地址，也是为了隐私保护。那有没有可能把输入地址和输出地址也关联起来呢？

就我们刚才讲了是说这些输入的地址有N个，我们可以认为他都是属于同一个人的，因为都受同一个人控制。输出地址当中一般会也会有一个找零钱的地址。那么有没有可能我们把这个找零钱的地址也找到？

好像有一点难度是吧？因为你有两个地址，你哪个知道是找林权的？就比特币生成这个交易的时候，并没有规定找零钱的地址。在output当中出现的位置，就不是说他一定要出现在第一个输出或者是最后一个输出。但是其实有些情况下，你可以把它分析出来，比如说我们看到具体的例子。

比如说第一个地址账户上有四个比特币。第二个地址。账户上呢有五个比特币。产生了两个输出，第一个输出转入了六个比特币。第二个输出转入了三个比特币，这个六写的不太好。

么这时候你们觉得哪个是找灵的地址？这个是找零的地址，这为什么？如果你是四转账，因数直接一个因数是4或者5就可以搞清楚个事。大家听明白了吗？如果这个是商家的地址，我干嘛要用两个input，实际上一个就够了。所以通过这种方法，我们也可以把输入地址跟输出地址也关联起来。

从理论上说，如果你要想更强的隐私保护，你可以怎么办？你可能以人为的产生一些没必要的输出，就为了迷惑敌人。但是就我前面讲的这些交易几乎都是用钱包软件生成的。现在很少有人手工生成这些比特币的转账交易，那么常用的比特币钱包就那么几种。所以如果把这个常用的比特币钱包生成交易的方式搞清楚，那么区块链上很大一部分转账交易都可以分析出来。常用的钱包到目前为止一般没有故意生成这些不必要的输出地址的。大家有问题吗？

好，这是我们讲的有可能破坏比特币匿名性的第一个方面就是这个人可以生成很多的地址账户，但是这些地址账户是有可能被关联起来的。第二个方面是这个地址账户跟你在社会现实世界中的真实身份也可能产生关联。什么时候会有这样的关联，就什么情况下别人有可能知道这个比特币账户对应着现实生活中的某个人呢？

你们觉得呢？任何让这个比特币系统中的比特币，这个虚拟的货币跟实体世界发生联系的时候，都有可能泄露身份。如果你光是在区块链内部玩，跟实体世界从来不发生任何联系，这个是没有问题的。一旦跟实体世界发生联系，就可能泄露你的真实身份。

这里面其中一个最明显的是什么？是资金的转入和转出。我们大家平时是没有比特币的对吧？你怎么得到你的比特币？你说你用钱去买，那就有一个资金转入区块链的过程。大家听明白了吗？就是你可以去交易所买，交易所的话你要登记注册，他一般是要有你的身份信息的，也可以有场外交易。

大家知道什么叫场外交易吗？对，两个人私下交易。比如说你有比特币了，这个同学想要买，他底下把钱给你，你把比特币给他。以前国外有一些专门做这种场外交易的公共场所，比如哪个公园旁边举了一大堆人我，但这个也会泄露你的身份，就根据场外交易直接交易的人也会泄露你的。

身。

份。过去的经验表明，就很多国家有反洗钱法。怎么防范用比特币进行洗钱的这种违法行为，盯住这个资金的转入转出链，其实是一个常用的手段。如果你有特别大的资金，像有些黑社会洗钱的，你要转入到比特币里面，或者是你有很多的比特币，你想转回成法币，这个你想要不引起司法部门的注意，实际是很难的。这个也是比特币隐私有可能被破坏的一个很重要的时机。就资金的转入转出。还有什么时候？

用比特币做支付的时候，如果是实体世界中你用比特币做支付。比如说国外有的商家是接受比特币支付的，你去一个咖啡店，你买一杯咖啡可以用比特币支付。有的餐馆你去吃饭可以用比特币支付。当然了，我个人觉得这是一个白的idea。大家想想这为什么是个bad？

对，他就可以信用卡支付，信用卡可以支付，比特币也可以支付。有的商家他是接受这种比特币支付的。

第一，延迟很大对吧？你要真的等六个确认的话，那等多长时间？等1个小时。第二，什么交易费也很贵，就传达顺费你一杯咖啡才多少钱？你那个交易费可能跟咖啡本身差不多贵了，这是个白的idea
d但不但怎么说，国外确实有收比特币的。

那么收比特币这个时候就会引起隐私泄露。就是你用于支付的这个账户跟你的真实身份是建立联系。而我们前面讲过，这个账户可能跟你比特币的其他账户之间也是有联系的。所以合在一起就很容易把这个人的很多情况都给摸清楚。这个其实不光是接受你支付的那个商家会知道，其他人其实也会知道。

我讲以前的一个例子。以前曾经有一家信用卡公司，他为了支持这种学术界的科研，把他的一些他收集到的一些信用卡的交易记录给公开了当你公开的时候，他做一些隐私保护，就是信用卡的号码都是取了哈希值的，你没有办法反推出信用卡号码是什么。然后个人信息像姓名、性别、年龄这些信息都给抹掉了。

信用卡号码不能完全抹掉，因为他这个目的是为了科研中只要你要研究各种不同的社会群体他的消费习惯，或者是根据这个人过去的消费行为推测他将来的消费。所以你你要有办法让这个研究人员把同一个人的不同的信用卡刷卡记录要关联在一起。所以信用卡号码不能完全不要他取一个哈希。只要你知道哪些交易是同一个人做的，但是你不知道这个人具体的信息是什么。好，他发布这些信用卡交易记录，为了科研目的，结果就真的有人做一个科研。这个科研其实不是研究信用卡的消费行为，而是研究怎么通过这些公开的数据能够推测出这个人实际上是谁。他证明你这种方法是不行的。

你们想想为什么？比如说我想知道你是谁，我是你的邻居。然后，去咱们这个neighbhood的旁边的一个grocery
store买菜的时候，你排在我前面，我看到你刷个卡，但我不可能看到你的信用卡号码，我也不知道他的哈奇值是多少。

但我知道在今天的这个时候，你在这个grocery
store买了东有一个消费记录，这个能有什么用？就在公布的这那么多的消费记录当中，我可以过滤到很多是留下那些在我这个时刻，在这个国store买过东西的一些消费记录。然后，过一段时间，比如说我们去pharmacy去买一些prescription药的时候，就医生开的处方药，你去领药的时候也是要交钱的。有copayment，我又看到了你在这个时候去做一个coppayment，让我再查一下有哪些信用卡号码的哈希值，在这个时间去过fararacy。那么你这样过滤几次之后，那个研究就发现用不了多少次，很快就能够精准定位出哪个哈希值是对应的是你。

大家听明白了吗？

比特币为什么讲这个例子？比特币有什么特点？就是对信用卡来说，有这个研究结果告诉我们什么信用卡记录不能公开，你采取匿名化措施，你取哈希之后仍然是不应该公开的。但是比特币这个交易记录它不是可以保密的，他都是公开的。

所以你去咖啡店，你去喝咖啡店的操作，你把你这个比特币账户告诉我。比如说对方的营业员，不光是那个人知道你的这个账户了，你周围其他的人如果有认识你的，也都会意识到你在这个时候在比特币网上做一笔消费。然后就区块链去查区块链在什么时候，区块链中有哪些账户在这个时候在这个咖啡店进行了消费，然后就可以推算出哪些账户有可能是你的。这么干一两次之后，你下次再去买披萨，你又用比特币去买，很快就能知道哪些账户是你的。这也是破坏匿名性的一种方法。

大家听明白吗？一个是不同的账户之间可以进行关联，另外一个就是你的账户跟你的实体世界中的真实身份也可以建立关联。所以比特币的匿名性并不是绝对的没有想象中的那么好。实际当中怎么样？实际当中那些用比特币的人，他们的匿名性保持的有多好。

保持的最好的是谁？所有用比特币用户的年中匿名性保持的最好的是谁？你说建立一个账户没有发生过交易的人人你明显保持的最好，这个回答是对的。但是这个人算不算真正意义上的比特币用户值得探讨。有一个人参与比特币的时间最长，全世界都想知道他是谁，但到现在也没有人知道他是谁。而中本聪它的匿名性保持最好。她匿名性为什么保持这么好？她丈夫打完钱，她根本没有他根本没有花钱。

就是中本聪为什么要发明比特币？早期的时候他为了宣传推广比特币，其实还是花了很大的功夫的。他在各个论坛forum上去去说这个事情，有人说是为了钱。因为早期比特币挖矿非常容易，他用他自己的笔记本电脑都可以挖矿，据说是囤积了大量的比特币，现在的话可能价值要几百个亿。所以有人说他发明这个比特币可以赚一笔，其实他的那些比特币到现在也没有划出去。

为什么？如果一旦花出去怎么样，你就要跟现实世界中的银行交易所发生联系。因为你要把比特币换成法币，比如说换成日元。就现在大家普遍认为这是个日本人，因为他名字是个日本人的名字，那这就会暴露他的真实身份，这是钟本聪不愿意做的事情。他宁愿这些比特币一个都不花，他也不愿意暴露自己的真实身份。所以他干这件事情应该说不是为了钱，可能是为了某种信念，为某种事业。再举一个例子，就以前曾经有一个叫思度的网站。

大家注意，这个思路跟咱们国家说的丝路基金没有任何关系。他这个是个非法的网站，这有人管它叫做。

一bay说伊legal go
drug。他像一bay一样有一个网上交易平台，而且它也像伊贝一样有一套reputation
system。你在网上进行交易之后，这个商家的诚信怎么样可以打分，他都有一整套的，只不过他卖的是违禁品，有各种各样的非法的物品。为了逃避司法制裁，他支付手段用的就是比特币。底下这个网络层用的是洋葱路油，就叫做拓。

然后他在美国还用一种一些匿名的邮寄的服务lonymous卖各种违禁品。最后怎么样呢？运行了大概两三年就被政府给查封了，他的幕后老板在旧丁山被捕了，被抓起来。更重要的一点是，这个人靠经营这个网站赚了很多比特币。就他被抓的时候，美国政府没收了十几万个比特币，这个在当时大概是价值几千万美元。说这个人是很有钱，但是他只是在纸面上很有钱。他在旧金山过的是非常简朴的生活，就住在一个一室一厅的公寓里面，根本看不出有钱。赚的这个比特币十几万个，一个都没有花，为什么林一花就暴露身份了，所以他一个都不敢花，即使这样，最后还是被抓下了。

具体抓的原因就具体抓的这个为什么就是怎么发现的这个细节没有公开。据说是这个人有几次是不小心用同一台电脑登录过他在真实世界中的某个账号和他的这个非法网站上的某个账号。这个网站被查封之后，过一段时间有人又开了第二版的思路，这个叫silroad
two。也是运行没几年也被查封了。还有一些类似的网上黑店，最后下场都不好。这个世间告诉我们什么？

比特币的匿名性没有我们想象中的好，尤其是如果你想用它来干坏事。就过去的经验表明，凡是用比特币从事违法活动，最后都能被抓起。中本聪能够那么长期的保持匿名性，实际上是属于个例，就并不是一个常态。而且他没有干坏事儿，中本聪没有干什么坏事情。另外其实还有很重要的一点，为什么中美聪能保持匿名？

比特币这个项目走上正轨之后，中本从其实就消失了。大家听不到他的声音。早期的时候他花了很多功夫走上正轨之后他就功成身退了。这也是他到现在都没有泄露身份的一个原因。他干这个事情不但不是为了钱，而且也不是为了名。他如果现在站出来的话，应该是很有名的，他也不愿意出头露面。你要如果是从事非法交易的话，你没法就那么消失，你得保持经营。

所以回到我们一开始问的那个问题，比特币的匿名性有多好？匿名是跟隐私保互相关联的，就我干的事情不想暴露真实身份害your
identity。但这个问题就在于你不想向谁暴露身份。

如果你就是个普通老百姓，你不想让你的周围的同事、亲戚朋友知道你有多少比特币，你有多少钱。你说这是我的隐私，我账户上多少钱，我也不想让周围的人知道，这个是比较容易实现的。就比特币现有的机制，在这种程度上保护你的隐私是比较容易的。如果是非法组织从事那种黑市活动，像那个哥们儿开私路，这个哥们儿美国联邦调查局想要抓他，这个时候要保持隐私就难很难得很多了。所以我们这种要有一种reasonable
expectation。

我们说一些技术问题，就假设你是一个比特币用户，你能采取什么样的方法尽量的提高你的匿名性。

我们前文说过，比特币协议实际上是运行在应用层的底层是什么？是个P2P的overlay
network
work。所以要提高匿名性要从两个方面入手。网络层怎么提高匿名性？比如说咱们先不说区块链，在区块链出现之前，你去网吧，你用网名发一个帖子，别人有没有办法知道你是谁？

知道是谁干的，大家听明白了吗？你去网吧，那有身份证对吧？他会登记。所以查一下你的埃批地址，就能知道实际上是谁做的。

埃批地址跟现实社会当中的真实身份是有很强关联性的。所以你比特币要实现这个匿名性，首先要实现在网络层的匿名性。对比特币来说，这实际上说的是什么？你比特币交易发布到这个网络上的时候，如果不保证网络层的匿名性，那么很多节点如果发现这个交易都是从同一个节点发出来的。那么从这个节点的埃批地址就可以推算出在物理世界中他的真实身份是什么。

好在网络层的匿名性是比较好解决的，就是在以前的研究当中，已经有很多的这个方法了。区块链是个新生事物，但是网络层的匿名性学术界已经有了很好的解决方案。那么比较普遍的就是用一种叫做多路径转发的方法。像我们前面讲那个洋葱路油，就这个兔。

就是这个原理，就怎么才能让大家不知道这个消息是谁发出来呢？这个消息不是由三的直接发给receiver，而是中间要经过很多跳，就application这个level要经过很多次转发，中间的每一个节点只知道它的上一个节点是谁。但是并不知道最早发出这个消息的人是谁。当然了，中间这些节点当中有一些可能是坏的，可能是compromise。但是只要是这个路径上有一个节点是诚实的，就能够把这个最初发件人的身份给隐藏起来。这是洋葱入油的一个基本的思想。好了，我们下面说application
layer。Application layer怎么实现匿名性？

我们前面讲破坏匿名性的一个原因是什么？同一个人的各个不同的比特币账户之间会被关联起来。因为区块链是个公开的账本，你花的每一个币都可以追溯到它的源头。从这个币最早是由哪一个铸币交易中产生的，然后这个币产生的参加的每一次交易都可以追溯过来。所以要起到匿名保护的作用。一种做法就是把各个不同的人的币混在一起，叫coin
mixing。

这个其实不光是区块链，就是在其他所有的领域需要达到匿名性的领域，这都是个常用的做法。就是把你的身份跟周围的人混在一起，让人分不清楚谁是谁，就call
mixing，让人分不清楚这些币是从哪来的。那么怎么做到call
mixing呢？有一些专门做call
mixing的网站，就他提供这种服务，收取一定的服务费。所有想做call
mixing的人，把这个B发给这些网站，他内部进行一些重组，然后你再把这个币取回来。你取回来的币一般来说就不是你当初发到这个网站上的币，他是随机抽取一些币给你。

这call
mixing的话，真正实施起来有一定的复杂性。如果你设计不好的话，可能有一些side
channel，有一些traffic
analysis。比如根据你当初存进去币的数额，能够推断出来哪些币实际上是你存进去的。还有timing
analysis，还有更重要的一点是什么？现在在这个区块链世界里，没有什么信誉度非常高的call
mixing的服务。就很多这种call
mixing的服务，它本身也是要保持匿名的。他一匿名造成的结果是什么？如果投进去的这些币被他卷款跑路了，你实际上是一点办法都没有的。

我们前面讲这个比特币的交易所，然后讲那些东西我们有讲过，就目前这个区块链世界的状态，有点像美国的西部片，是属于Wild
West，法律是鞭长莫及的。交易所经常会出事儿，像那个门头沟的事件，也有些交易所卷币跑路的。Call
mixing service也是一样。

还有一种做法是什么？就是我们不一定要特意的去做call
mixing。有一些应用，这些应用本身带有call
mixing的性质。就比如说在线情包，在线钱包，它是要很多人都把钱去存到这个钱包里，那么他就有可能把这些人的币给混起来。然后你将来从这个钱包中取回你的币的时候，可能就不是你当初存进去的币了。就在线钱包本身这个应用就有可能带有这种call
mi性的效果。但是在线钱包并不保证要履行这个call mixing的功能。

还有一个是什么？交易所就这种加密货币的交易所，一般来说它是有一种天然的call
mixing的行为。大家想想为什么？比如说我有一些比特币，我把它上传到一个交易所存在里面。过一段时间我觉得比特币的价格会下跌，我就把它卖出去换成美元或者是换成UDT。然后又过一段时间我可能买入以太币，我有可能把它换成莱特币。折腾几次之后，我可能又把它再买回比特币，然后我可以把它提笔提出来存在我的本地。这个时候我存在本地的这些比特币，一般来说就不是我当初存进去的比特币了。

你想想是不是因为我存进去那些比特币我已经卖掉了，你不知道他可能已经被哪些人提币，提到他自己的钱包里去了。说这个本身带有一定的comixing的性质，当然这个前提是什么？前提是这个交易所不会泄露相关的记录，就相关的提币存币这种转换的记录，否则的话这个整个过程暴露出去也是不行的。这是我们说的这个应用层。

为什么保护隐私性难度挺大？本质原因是区块链是公开的，而且是什么是不可篡改的。我们前面反复强调这个区块链的不可篡改性好像是个好事情。其实这种不可篡改性对于隐私保护来说是灾难性的。因为一旦你某一个交易不小心把你的身份暴露出去了，这个交易永久的写在区块链里，你想抹都抹不掉了。这也是为什么我们说账户之间的关联性是要小心的。如果每个账户都是单独使用的，你有一个账户暴露出去，这个影响还是比较有限的。如果都串在一起，能够关联在一起的话，那么一个账户暴露出去，后面就都完了。

大家有问题吗？

没有问题，我们下面讲一下零知识证明，这部分内容我们会用一下PPT。

好，我们讲一下零知识证明。零知识证明是指一方这个证明者向另一方验证者证明一个乘述是正确的，而无需透露除了该陈述是正确的之外的任何信息。

大家能明白吗？

你们能想到某个零知识证明的例子吗？就是我们以前讲的那些比特币的相关内容当中，有哪些可以认为是零知识证明的。

比如说我说某一个比特币账户是我的我要证明这一点。

怎么证明？

如果这个比特币账户是我的，说明什么？说明我应该知道他的私钥，对吧？就以实际上是要证明我知道他的私钥，但是我不能把私钥告诉你，这显然的。所以我要向你证明，我知道私钥，但我又不能把私钥告诉你怎么办？签名就我可以产生一个用这个私钥进行的签名。假设你是知道这个账户的公钥的，那么你可以验证一下这个签名的正确性。

这个例子当中，这个证明者是谁？是我，对吧？验证者是你证明这个陈述是什么？我知道这个账户的私要，但是我没有把这个私要透露给你。

大家注意一点，就我举的这个例子算不算是零知识证明其实是有争议。就这个证明过程中，我没有把私药亵渎给你，但是我泄露了用这个私药产生的一个签名，对不对？这个跟零知识证明中的要求无需透露，除了该乘述是正确之外的任何信息还是有一定差距的。所以这个算不算零时零知识证明其实有一定争议。这个其实在实际当中要看你的应用场景，就你透露的这些额外信息有没有问题，要看你的应用场景。大家明白这个零知识证明的意思了吧？我们讲一下同态隐藏。

零知识证明的数学基础是同态隐藏。大家看一下同态隐藏的三个性质。

第一个性质说的是什么？说的是这个加密函数值，这个E不会出现碰撞。这个跟我们说的哈希函数不一样，哈希函数有可能有哈希碰撞，这个是不会出现碰撞。如果这个输入是不相等的，XY不等于Y那么一算出来的加密值一X跟EY也是不等。这个性质反过来说明什么？

你说一S跟EY不等的话，S跟Y是不等的。这个反过来说明什么？说明如果两个加密函数值是相等的，那么它原来的输入也是相等的。大家听明白吗？这是它的逆否命题。如果意跟意外是相等的，说明X跟Y一定也得是相等。

第二个性质说明什么？

说明那个加密函数是不可逆的。你知道这个加密的值没有办法推出原来的输入的值。我们第一节课讲那个密码学当中的哈希函数的时候，那个性质跟这个是类似的。大家还记得这个性质叫什么吗？

叫hiding
property。从这个哈希值没有办法知道原来的输入值，这个也是类似。第三个是最重要的，这个叫同态运算，他说的是什么？

他说的是对这些加密之后的函数值进行某些代数运算，等价于对这些输入直接进行代数运算，然后再加密。比如说第一个同态加法。加密值的和就等于和的加密，或者说它不一定非要相等，它可以通过这种和的加密能够算出来。

同态乘法也是类似的。在加密后的函数值的乘积等于乘积之后再加密。我们有了这两个性质，同态加法和同态乘法，就可以把它扩展到这个多样式上。下面我们看一个例子。

这个例子当中的证明者是谁？是al丽对吧？验证者是报要证明的陈述是什么？阿里知道两个数，X和YX加Y
等于7，需要隐藏的是什么？X和Y的具体数值。大家想想怎么挣。

然后这个错误的求出一X加Y的值。爱丽丝给出的颜值意外加起来和他X加等于7的再进行一个加密。大家听明白了吗？Alx把一和1Y的值发给鲍，然后鲍勃可以通过这两个值算出一X加Y的值，然后再算一下一期的值。如果这两个相等，说明验证就通过。这个证明的方法为什么满足我们前面说的要求？

但是暴不能根据X和意外反推出来的。以这是哪个性质？这是第二个性质，不可逆的性质。Alx给出了一X以外，Bob没有办法知道X和Y的值，你接着说，所以他就满足了，就是说没有给出X。满足了这个条件，对，另外两个性质在哪用的？这就是领知证明的定义了。不是我说同态运算的另外两个性质在哪用，一个是平泰家纺，平泰家用。就是同态加法的性质是在这用的，就是Bob可以通过一X和1Y算出一X加Y的值。

然后，第一个性质用没用到？第一个性质是没有碰撞。

就是一X加Y 等于17说明什么？

说明X加Y一定等于7，为什么？因为没有碰撞，就我们前面讲的逆否命题没有碰撞，说明S跟Y不等，E跟EY一定不等。反过来说，如果这两个是相等的，那么两个输入也一定相等，这是一个最简单的证明的例子。

这个例子其实有一些缺陷，这是个比较简单的版本。Bob可以用蛮力算法去猜除原始的X和Y是多少，就是鲍B虽然从这个一X没有办法知道X是多少，但是它可以遍利X的各种取值，用蛮力算法去一个一个比，看哪个恰尔跟一X相等。所以在更复杂的这种解法当中，Alex在把输入送给鲍B之前，要对这个X和Y的值做一些随机化处理。随机化处理的方法是保证S和Y加起来还是不变的。

盲签，这是个很有意思的事儿。大家还记得吗？我们第一节课讲比特币共识的第一节课的时候，我在讲比特币的共识协议之前，举过两个简单的共识协议的例子。第一个我们说就是央行发布这种虚拟货币，我们先不考虑去中心化的问题。他发布一个100块钱的有个央行的签名，发布一个50块钱有个央行的签名。我支付的时候就把这个带签名的这个货币直接给你就行了。我们说那个方法是不行的。

还记得原因是什么吗？

因为容易被复制，因为它没有办法防范double spending
attack。然后我们又说了第二个方案是什么来着？

是每一张钱在谁手上做了一个账户档，做了一个维护。就每一个数字货币要有一个编号，就跟人民币有编号一样，数字货币也得有个编号。然后央行有一个数据库记录的这个编号的钱有没有被花过，是应该是在谁手里的，这样可以检测double
spending，这我们当时讲的第二方案。

第二个方案有个什么问题？但一个问题就是它是中心化的方案，央行被invol到每一个transaction当中还有一个问题就是跟我们今天讲的隐私保护相比，央行是什么都知道的。The
central bank knows everything.

你做的每一笔交易跟每一个人的交易都要通过央行，对吧？所以央行知道你的所有交易信息。那么有没有什么办法，我们既让央行做这种中心化的记账检测，达bo斯班ding，又不让他知道呢？大家听明白这个需求了吗？就是这个虚拟货币的编号不能是央行产生的，改成谁产生的，改成我产生的。比如说我在央行那里存了100个什么币央币，我要取一个央币出来，每个币也得是有一个编号，我自己在本地产生一个编号。这个编号不能告诉央行，但是你不告诉央行有什么问题。

我们前面那个方案说是我花钱的时候，我把钱给你。我们假设央行的公钥是大家都知道的，你可以用公钥验证你整个B的正确性，包括B的面值，包括这个边号。你现在这个编号你不告诉央行，那这个编号怎么保证是正真的，不会被篡改掉？进用到盲签。这个用户提供这个编号，这个序号银行是要签名的，但是银行签名的时候看不到这个序号的内容。

返回这个token。这个token就是银行对这个序号的一个签名，同时减少A的存款。比如说我取了一个B他把我的钱就给减少一个单位。然后用户A给B进行转账交易的时候，把这个序号的内容这个时候是明文。就B这个人是知道这个编号的具体内容的，和这个token央行的签名给这个B。然后B要把这个序号和签名给银行验证。这个时候这个序号也是明文，也是告诉银行的这个验证的目的是什么。

Double
spending对不对？就银行要记录一下这个序号的币是不是被花过。他要维护一个数据库，然后验证。比如说没有划过验证通过之后增加这个B的存款，这样设计的目的是什么？

他不知道B的这个BB的这个co是从哪来的。因为当初银行把这个钱给A的时候，把这个虚拟货币给A的时候，这个编号是A自己产生的，而且没有告诉银行。所以银行只知道我给你一个币是哪个编号的，B我不知道，然后你拿着这个币去给别人花的时候，别人说来问我验证有一个编号的币。我没有办法知道你这币是从哪儿来的。

大家听明白了吗？

这里面用到一些crypto
magic，其实原理并不复杂。如果大家真想学的话，这个盲签的原理并不复杂，在不知道具体内容的情况下还要对它签名。最后我们讲一下零币和零钞这个motivation是什么。我们说比特币在一定程度上或者说在很大程度上提供了匿名性，就sudom但是它不能够完全消除关联性，就管它叫link
ability。那么我们能不能设计一种新的加密货币？这个加密货币从一开始这个体系结构设计上就用了密码学的原理保证匿名性。这就是灵璧和凌超的这个motivation。专门为了匿名性设计的加密货币。

这个灵力是存在一种基础币base
co比，如说这个基础币可以是比特币，还有这个灵币zero款。你用的时候，你要证明你本来是有一个基础币的。你把这个基础币搞得是不能花了，就unstandable，然后换取一个灵币。然后灵币在花的时候只需要证明用零知识证明，证明你花掉的币是系统中存在的某一个合法的币就行了。但是不用透露你花的具体是系统中的哪一个币。听明白了吗？这个是跟比特币的一个本质区别。

比特币是怎么样的？每一笔转账交易都要说明币的来源，你这个交易中花掉的币是过去的哪个交易中产生的，这样才能够保证你花掉的币的真实性，不是凭空捏造出来的。但是灵璧和灵钞是不一样的，灵璧和林超是说你证明的时候，从数学上可以保证你花的这个币是以前这个区块链上某个合法存在的币，但是不知道具体是哪一个。这样的话就把这些关联性给破坏掉了。你没法追溯了。这个林超根本就没有基础币，就完全对手就是那种zero
call。

这个凌璧和凌超怎么实现的，我们在课上就不详细讲了。这里面的数学原理是很复杂的。这个如果要讲的话，涉及到比较深的密码学数学方面的知识，大家有兴趣的话可以看一下参考的一些文献。

另外一个原因，为什么我不在课上讲？就是这些专门为匿名性设计的新的加密货币，到现在也不是很主流。像林超这个zero
cash，有的交易所上是可以买得到的，但是也不是很常用，就这些都不是主流的加密货币，为什么呢？一方面是说这些加密货币为了匿名性是付出我一定代价的，他在性能上是有一定的损失的。而且他在数学原理上对初始化有比较严格的要求，就初始的时候用的随机源要能够销毁掉。如果没有很好的销毁掉的话，那么会有一定的安全漏洞。

还有一个更重要的原因是什么？可能需要强匿名性的用户本来也不是很多。可能大多数用户觉得比特币的这种匿名性其实也够用了，反正我也不干什么坏事，有比特币这个匿名就够了，他就不愿意为了有更强的匿名性再去用一种新的加密货币。

还有一个什么原因？虽然这个灵璧和任灵超在数学原理上提供了很强的匿名性，就刚才我们讲这个基本的运行过程。但是它真的就是百分之百匿名安全的吗？

我们前面讲过影响匿名性的因素，有没有哪个因素他仍然没有解决掉？

对与实体发生交互的时候，比如说真的有人想用这些币去干坏事。你把很大的金额转换成这种加密货币的时候，或者是把这些加密货币转换成现金的时候，仍然要暴露身份。你这些加密货币数学上设计的再好，只是说他已经在区块链当中之后，他进行转账有匿名性。他跟外面交互这个匿名性仍然是一个他的弱点。所以从这个意义上说，他仍然没有提供百分之百的利密。同学们有问题吗？

好，没有问题的话，我们这节课就讲到这儿。
