**11.11-BTC-问答(Av37065233,P11)**

这节课我们回顾一下前面几节课所学过的关于比特币的知识，以课堂提问的方式帮助大家加深一些理解。我们先说第一个问题，转账交易的时候，如果接收者不在线怎么办？就比如说你想把一些比特币转给某个人，那个人当时没有连到比特币网络上，这个时候会出现什么情况？哪个同学说一下。

不影响转到这个值。如果我知道他的比特币就是。

提这笔钱如果只是单纯的转账的话，我只需要知道他的地址，即使他是离线。

这个说的是对的。这个时候不需要接收者在线转账交易，只不过是在区块链上要记录一下，把我这个账户上的这些比特币转到他的账户上。他是不是当时连在比特币网络里，这个是没有关系的。

下一个问题，假设某个全节点收到了一个转账交易，有没有可能转账交易中接收者的这个收款地址是这个节点，以前从来没有听说过。可能吗？这是可能的。就是比特币账户在创建的时候是不需要通知其他人的。在本地产生一个公司要对就可以了。只有在以后产生的这个收款地址，第一次收到钱的时候，其他节点才知道这个账户的存在。下一个问题。如果你账户的私钥丢失了该怎么办？

就是泄露其实很容易丢钱的时，应该把它尽快转移到一个比较安全的账户。

你说的跟我问的不完全一样，我是说四药丢失了，你说的是私药泄露了，但你说的是对的，就私钥丢失之后，其实是没有办法的，这个账户上的钱就变成了死钱，永远取不出来了。这个跟我们平时的生活体验不太一样。像银行，你银行的账户密码丢了，你可以去银行查验一下身份，进行重置密码在去中心化的系统里，像比特币这种系统里，是没有人可以给你重置密码的，这个大家一定要注意。

另外我讲一下就有些加密货币的交易所，一般来说这些交易所是中心化的机构。那么在交易所开办一个账户的时候，一般来说是要提供身份证明的。如果你想在某个加密货币的交易所有个自己的账户，那么就类似于银行开户一样，一般也是要经过身份验证。这种情况下你把你的比特币保存在交易所里，私钥实际上是由交易所来保管的。你登录这个交易所的话，是按照登录银行差不多的程序，就有一个账户名，有一个密码。一般来说还需要二次验证。比如说用Google身份验证器产生的一次性密码，通过二次验证然后登录。这种情况下，如果你的账户密码丢失了，你是可以去跟交易所联系，通过身份验证之后重置密码，这个跟我们刚才讲的比特币账户的私钥丢失是很不一样。

有一些在线情包也提供这个保管私钥的功能。但是大家不要误解我的意思，我并不是说这些交易所或者是在线钱包比我们自己保管私钥更安全。其实比特币的这些交易所或者说加密货币的交易所，目前处于一种缺乏监管的状态。这个跟股票交易所是很不一样的。历史上曾经发生过很多次加密货币的交易所被黑了的情况，黑客从里面偷走了大量的这种加密货币。其中最著名的一个例子就这个门头沟的例子。

大家听说过这个例子吗？这个中文翻译成门头沟，这个曾经是全世界最大的一个比特币交易所，交易量占到了全球比特币交易量的70%。他是设在日本的，后来就被黑客攻击了，丢失了大量的比特币。这个交易所后来破产了，他的CEO被判刑了。而且这个不是个例，就是各种加密货币交易所出现问题的情况发生过很多次，也有的是交易所监守自道，有的工作人员、管理层的卷款跑路都发生过。所以这个大家也要提高警惕。相比之下，有些冷钱包或者是硬件钱包是比较安全的。

下一个问题，如果你的私钥泄露了怎么办？比如你发现你的账户上出现一些可疑的交易，这个时候该怎么办？这个其实刚才那个同学回答过了，这个时候你应该尽快的把你账上的钱转到另外一个的安全账户上。这个也跟我们平时的生活体验不太一样。如果你的银行账户上出现一些可疑的交易，你可能首先想到的是通知银行能够能不能怎么把你的密码重置了，然后把你的账户冻结了，免得别人把你的钱取走。这些在区块链的世界里都是做不到的。

比特币这个账户所谓的密码是什么？就是它的私钥产生账户的时候生成的公钥和私钥。对这个公司要对，一旦生成之后是没有办法改的，你没有办法再改成另外一个私药，你可以生成一个新的账户，但是原来那个账户的私钥是改不了的。同样的，你也没有办法阻止别人发布从这个账户上转账的交易。任何有私钥的人都可以发布一个转账交易，把这个账户上的钱转走，这个也是没有办法冻结的。所以你能做的只能是在第一时间抢在别人之前，把你自己账户上钱转到一个安全的账户上。

下一个问题，如果转账的时候写错了地址该怎么办？比如说你本来想把钱转给某个人，但是你写错了，转给另外一个人。

有什么办法吗？没有办法，这也是这个回答也是对的，没有办法取消已经发布的交易。就比特币当中转账交易一旦发布到区块链上，就没有办法取消了。他没有提供这种机制来取消某个已经发布的交易。

如果你转账转到别人的地址，如果你知道是谁的地址的话，可以跟对方联系一下，看看他愿不愿意把这个钱还给你。但这个也只能跟他商量，这个没有办法强迫。如果你不知道是谁的地址，或者转的是一个不存在的地址，那就没有办法。什么叫不存在的地址？就我们说这个地址是怎么产生的，是由公钥的哈希得到的。有些地址它其实不是公钥的哈希得到的。比如说我们第一节课讲的digital
commitment的例子。

这个大家还记得吗？你想把某项内容的哈希值发布到区块链上，证明你曾经在某个时间知道某个事情。比如说你有某个文件，你想取个哈奇之后放到区块链上。我们在几节课之前讲比特币脚本的时候，讲过一种比较经典的做法，大家还记得吗？

这个记得吗？你可以把你要发布的哈希值放在这个后面，这个后面写什么？反正是没有人管的。这个是个比较标准的做法，是推荐采用的方法。但是有的人他不这么干，他怎么干呢？

他用这个哈希值生成一个看上去像比特币地址的东西。就比如说。A转给B。这个正常情况下，B应该是某个比特币账户公钥取哈希之后得到的地址。然后他这个地方就把它要保存的那个哈希值生成一个地址，作为收款人的地址。这个地址是没有对应着私要的，他其实是个假的地址。

这比特币系统并不知道你这个地址是真的还是假的。你这个哈希志是怎么来的，别人也看不出来。所以这样的转账的钱就变成了死钱了，这个转账永远不可能被取出来，大家听明白了吗？这种做法一般的就是说牺牲一点比特币，比如说赚很少一点钱。

换取比如说0.00一个比特币，换取往这个区块链里写入这个哈希值的一个机会。这个做法是不提倡的，因为什么呢？因为这样你这个转账交易的输出会永久的保存在ut
XO里面。全节点收到这样一个转账交易，他其实并不知道你这个地址是真的还是假的，他不知道你这个钱其实是花不出去的，所以他必须永久的把它保存起来，这个对全节点是不友好的。

我们接着问一个问题，我们说到这个普分，说到这个op
return，他们实际当中是怎么操作的？比如我们说当一个全节点收到一个转账交易的时候，他首先要检查一下这个交易的合法性。只有合法的交易才会被写到区块链里，对不对？而我们讲operation的时候，我们说过这个语句是无条件的要返回错误。既然他无条件都返回错误，怎么可能通过验证，怎么可能被写到区块链里呢？

这个其实是有一个同学曾经问过我的问题。

有什么想法吗？

你说比特币里面对这个oper有特殊的处理，虽然它返回错误，我仍然是把这个交易写到比特币的区块链里。其实不是。

主要是因为你把这个发布出去了，然后。你做的地，你就是你发布出去这个区块别的矿工验这的话也没什何问题。你这就可以把我说，不管你里边直行那个。

那问题就在于，只要能你说你说意思说反正发布出去之后，别人能验证通过就可以放到区块链里。不管有没有什么错误，但如果他验证过程中出现错误，怎么可能写到区块链里？

这里面有一些小的细节需要我们想清楚的。

什么叫验证通过？

没有问题。

然后对日识结果和解锁要拼起来再去执行。

没有问题。如果抛出错误，怎么可能没有问题？

就你们几个说的，对于这个大的过程基本上都是对的那其中有一个小的细节需要想清楚。

验证的时候是怎么验证的？是把当前这个交易的输入脚本跟前面那个交易那个币的来源的交易的输出脚本拼在一起，看能不能顺利执行。这个执行过程中是不可以抛出错误的，如果抛出错误就不是合法交易。这些都没有错，关键在于这个地方是写在哪儿的。这是写在当前交易的输出脚本里的。大家听明白了吗？所以验证当前这个交易合法性的时候，不会执行这个语句。

这是一个大家要想清楚的一个细节。当前这个交易的输出脚本在验证这个交易的合法性的时候是不会被执行的。什么时候会被执行？有人想花这笔钱，后面要再有一个交易，要花这个交易的输出的时候，才会执行到这个交易的输出交段。大家听明白了吗？所以判断这个交易能不能写入区块链是不是合法的时候，这个语句根本不会执行到。

下一个问题。

下面这个问题也是有一个同学问过我的，就我们讲挖矿，比特币挖矿是在干嘛？就是在尝试大量的看看有没有哪个n是符合难度要求的。那么会不会有的矿工偷答案？就比如说他自己没有找到合适的n其，他矿工发布了一个他收到这个区块之后，查一下这个n是符合要求的，然后就把它作为自己找到的n发布出去。你怎么知道是哪个矿工最先找到的这个？

Huh?

你能说的具体点吗？

就是看这个。即使他偷懒，他也不能把。

这个说的是对的。大家听明白了，就是发布的区块里有一个。Calling base
transaction里面有一个收款人地址是这个挖到矿的矿工的地址。比如说A如果挖到了矿，那么这就是A的收款地址。如果你要偷答案的话，那么要把这个收款地址换成你自己的地址，对吧？而你这个地址如果一变的话，那么这个call
n base transaction的内容就发生了改变。

这样会导致什么？导致这个motree的根哈希值会变化，因为这个交易和区块中所包含的其他交易是合在一起构成motr的，任何一个地方发生改变，最根哈希之就会变。而这个n是在哪儿的？在快手里面跟哈希纸也是在快手里面block
header的内容发生了变化之后，原来找到的就作废了，所以不可能偷答案。因为每个矿工挖到的这个是和他自己的收款地址绑定在一起的。

下一个问题就我们前面说过，交易费可以看作是发布一个交易的时候给矿工的一点小费。那么你怎么知道这个交易费该给哪个矿工？就是事先你怎么知道哪个矿工会挖到矿。

之前不知道，但是我会把交易费写出去，会给多少交易费。完了之后谁就是说谁能把我这个交易打包到区块去的一个泡沫。不需要知道就是谁。

你这个说的很清楚，大家听明白了吗？就是事先不需要知道哪个矿工会得到这个交易费，交易费是怎么算的？

只要total input大于total
outpu这个差额就是交易费。就你发布的交易的里面，一个交易可以有很多个输入，也可以有很多个输出，总输入减去总输出，它的差额就是交易费，给谁不需要实现。知道哪个矿工挖到矿了，就可以把这个区块里所包含的那些交易的这些差额都收集起来。所以他自己的交易费。好，下面我们看一下比特币上面的一些统计数据。

好，我们看一下比特币的一些统计数据，这个显示的是比特币区块链的大小的变化情况。我们可以看到这个区块链是越来越大了，size子不断增大。这个其实也不奇怪，因为所谓的叫区块链是一个appponly耐者指纹往里面添东西。那么区块链的长度越来越长，它的size就越来越大。目前这个size对于当前这个硬盘的容量来说，还是完全没有问题的。区块链的大部分内容是可以保存在硬盘上的。

这个是ux
o集合的大小。这个集合也是总的趋势是不断变大的，有一些波动。这个主要原因就是比特币上面这个交易多了之后，uso的集合会跟着一起变大。当然还有另外一方面是一些历史原因造成的，就是有一些账户可能是私钥丢失了。所以这些账户对应的这些输出在uxo里就要永久的保存下去。那么时间长了之后，这种情况累积下来也会变多一点。

这个是比特币矿池挖矿的情况。我们可以看到这个挖矿集中化的趋势也是很严重，所谓的叫mining
centralization。几个大的矿池加上系统中总算力的很大一部分。

这个是比特币的价格变化情况。我们在第一节课的时候给大家看过这个图，这个是比特币的市值的变化情况，跟刚才那个价格的变化基本上是一样的。这个市值是绝对的市值，不是说在加密货币整体中占了百分比。

这个是比特币的交易量，这个大家看有一个什么样的趋势？最后这两年交易量窜的很厉害，而且波动非常大。它这个交易量是按照美元价格算出来的交易量，所以这个波动当中有一部分是比特币本身的价格波动造成的。

这个是每天的交易数目。总的趋势也是不断增长，到今年年初的时候。比特币的价格掉下来了，它交易数目也掉下来了。

这个是每个区块的交易数量。大家看看这个曲线的形状跟我们前面这个曲线。是不是很接近，看就很像对吧？这两个曲线不是偶然的，因为每天产生的区块数目是差不多的。这个难度调整算法要把出块时间稳定在十分钟，那么这样的话每天能产生多少个区块，就是差不多的。交易数目的变化主要就是因为每个区块里所包含的交易数目发生的变化。

我们看一下这个交易数目。我们以前算过一个理论上的上限，每个区块有多少个交易，大家还记得吗？差不多4000个。按照一兆的字节来算的话，差不多4000个，现在这个情况是远远没有达到这个上限。这条线是1500个吗？所以有很多人说这个一兆的上限太小了。但是另外一方面，真实的区块链上，实际上很多区块是没有装满的。大家看看还有问题吗？

好，没有问题就到这儿。
